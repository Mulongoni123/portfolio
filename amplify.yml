version: 1
frontend:
  phases:
    preBuild:
      commands:
        # Update system and install prerequisites
        - apt-get update && apt-get install -y wget
        # Download and install .NET 8.0
        - wget https://packages.microsoft.com/config/ubuntu/22.04/packages-microsoft-prod.deb -O packages-microsoft-prod.deb
        - dpkg -i packages-microsoft-prod.deb
        - rm packages-microsoft-prod.deb
        - apt-get update
        - apt-get install -y dotnet-sdk-8.0
        # Verify .NET installation
        - dotnet --info
        # Restore NuGet packages
        - dotnet restore
    build:
      commands:
        # Build and publish the application
        - dotnet publish -c Release -o ./dist
  artifacts:
    baseDirectory: /dist/wwwroot
    files:
      - '**/*'